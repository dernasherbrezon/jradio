package ru.r2cloud.jradio.blocks;

import static org.junit.Assert.assertArrayEquals;

import org.junit.Test;

public class FirdesTest {

	@Test
	public void testGaussian() {
		float[] actual = Firdes.gaussian(1.5, 2 * (48000 / 9600), 0.5, 12);
		float[] expected = new float[] { 0.039070457f, 0.07415177f, 0.12205514f, 0.17424175f, 0.21572968f, 0.23164831f, 0.21572968f, 0.17424175f, 0.12205514f, 0.07415177f, 0.039070457f, 0.017854061f };
		assertArrayEquals(expected, actual, 0.0f);
	}

	@Test
	public void testLowPass() {
		assertArrayEquals(new float[] { 0.001008346f, -6.822763E-4f, -8.1304566E-4f, 0.0016567904f, -3.310066E-18f, -0.002787134f, 0.0022303094f, 0.002859019f, -0.0058610104f, 8.506423E-18f, 0.009095494f, -0.0069024456f, -0.008413093f, 0.016501362f, -1.5403145E-17f, -0.02406701f, 0.01799467f, 0.021901557f, -0.04362453f, 2.1149863E-17f, 0.07096524f, -0.060137074f, -0.09201361f, 0.3013133f, 0.59955025f, 0.3013133f, -0.09201361f, -0.060137074f, 0.07096524f, 2.1149863E-17f, -0.04362453f,
				0.021901557f, 0.01799467f, -0.02406701f, -1.5403145E-17f, 0.016501362f, -0.008413093f, -0.0069024456f, 0.009095494f, 8.506423E-18f, -0.0058610104f, 0.002859019f, 0.0022303094f, -0.002787134f, -3.310066E-18f, 0.0016567904f, -8.1304566E-4f, -6.822763E-4f, 0.001008346f }, Firdes.lowPass(1.0, 20.0, 6.0, 1.0, Window.WIN_HAMMING, 6.76), 0.0f);
	}

	@Test
	public void testFromGnuRadio() {
		assertArrayEquals(new float[] { 0.00111410965f, -0.000583702058f, -0.00192639488f, 2.30933896e-18f, 0.00368289859f, 0.00198723329f, -0.0058701504f, -0.00666110823f, 0.0068643163f, 0.0147596458f, -0.00398709066f, -0.0259727165f, -0.0064281947f, 0.0387893915f, 0.0301109217f, -0.0507995859f, -0.0833103433f, 0.0593735874f, 0.310160041f, 0.437394291f, 0.310160041f, 0.0593735874f, -0.0833103433f, -0.0507995859f, 0.0301109217f, 0.0387893915f, -0.0064281947f, -0.0259727165f, -0.00398709066f,
				0.0147596458f, 0.0068643163f, -0.00666110823f, -0.0058701504f, 0.00198723329f, 0.00368289859f, 2.30933896e-18f, -0.00192639488f, -0.000583702058f, 0.00111410965f }, Firdes.lowPass(1.0, 8000, 1750, 500, Window.WIN_HAMMING, 6.76), 0.0f);
	}

	@Test
	public void testRootRaisedCosine() {
		assertArrayEquals(new float[] { 0.009424058720469475f, -0.0010619648965075612f, -0.054543860256671906f, 0.022260747849941254f, 0.29345303773880005f, 0.4609359800815582f, 0.29345303773880005f, 0.022260747849941254f, -0.054543860256671906f, -0.0010619648965075612f, 0.009424058720469475f }, Firdes.rootRaisedCosine(1.0f, 10.0f, 4.0f, 0.6f, 11), 0.0000001f);
	}

	@Test
	public void testRrcFromGnuRadio() {
		assertArrayEquals(new float[] { -0.04609205573797226f, -0.02069387212395668f, 0.050548505038022995f, 0.14850808680057526f, 0.23387153446674347f, 0.2677156329154968f, 0.23387153446674347f, 0.14850808680057526f, 0.050548505038022995f, -0.02069387212395668f, -0.04609205573797226f }, Firdes.rootRaisedCosine(1.0f, 4.0f, 1.0f, 0.35f, 11), 0.0000001f);
	}
}
